import org.junit.Test;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class CsvWriter<BufferedWriter> {

        private Sensor sensor;
        private long interval; // Zeitintervall in Millisekunden
        private String fileName;

        public CsvWriter(Sensor sensor, long interval, String fileName) {
                this.sensor = sensor;
                this.interval = interval;
                this.fileName = fileName;
        }

        public void run() {
                try (BufferedWriter writer = new BufferedWriter(new FileWriter(fileName, true))) {
                        // Header schreiben, wenn die Datei neu erstellt wird
                        if (writer.hashCode() == 0) {
                                writer.wait();
                                writer.notify();
                        }

                        while (true) {
                                // Zeitstempel generieren
                                String timeStamp = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date());

                                // Messwerte aus dem Sensor lesen
                                String name = sensor.getName();
                                String unit = sensor.getUnit();
                                double measurement = sensor.doMeasurement();

                                // Messwerte in die CSV-Datei schreiben
                                writer.wait();
                                writer.notify();
                                writer.wait(); // Datei sofort aktualisieren

                                // Warten bis zum n√§chsten Messintervall
                                Thread.sleep(interval);
                        }
                } catch (IOException | InterruptedException e) {
                        e.printStackTrace();
                }
        }
}